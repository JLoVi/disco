#+TITLE: Event Paths
#+STARTUP: showall 

* Replicated Events

  Events that get replicated are Add/Update/Remove calls for the
  following resources: 

  - Cue
  - CueList
  - CuePlayer
  - ...
  
  Ok.

#+BEGIN_SRC plantuml :file replication_of_assets.png
title Replication of Assets

hide footbox

box "User"
    actor "Alice" as C
end box

box "Iris (Leader)" #Lightblue
    participant "Dispatcher" as A
    participant "Raft" as B
end box

box "Cluster" #LightGreen
    participant "Raft Members" as D
end box

box "API Clients" #red
    participant "Locally Connected\nAPI Clients" as E
end box

C ->  A: AddCue
activate A
A ->> B: << Strategy Replicate >>
activate B
B --> D: Replicate to Members
activate D
B <-- D: Replication Successful
deactivate D
B ->> A: << Strategy Publish >>
deactivate B
D --> E: Publish on API
activate E
A --> E: Publish on API
deactivate E
A ->  C: Apply to State and render
deactivate A
#+END_SRC

#+RESULTS:
file:replication_of_assets.png

* Processed Events

  Events that are tagged to be processed are special events that need
  to be.

#+BEGIN_SRC plantuml :file processed_events.png
title Processed Events

hide footbox

box "User"
    actor "Bob" as A
end box

box "Iris (Leader)" #LightBlue
    participant "Dispatcher" as B
end box

A -> B: << AddSession >>
activate B
note right of B: Create Snapshot
B --> A: << Respond with Snapshot >>
deactivate B
#+END_SRC

#+RESULTS:
file:processed_events.png

* Published Events

#+BEGIN_SRC plantuml :file published_events.png
title Published Events

hide footbox

box "User"
    actor "Eve" as A
end box

box "Iris (Leader)" #LightBlue
    participant "Dispatcher" as B
end box

box "API Clients" #LightGreen
    participant "Client A" as C
end box

A -> B: << UpdateSlice >>
B -> C: << Pass-Thr >>
#+END_SRC

#+RESULTS:
[[file:published_events.png]]

